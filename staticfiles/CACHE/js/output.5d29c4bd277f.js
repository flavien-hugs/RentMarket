(function($){"use strict";try{new CustomEvent('IE has CustomEvent, but doesn\'t support constructor');}catch(e){window.CustomEvent=function(event,params){let evt;params=params||{bubbles:false,cancelable:false,detail:undefined};evt=document.createEvent('CustomEvent');evt.initCustomEvent(event,params.bubbles,params.cancelable,params.detail);return evt;};CustomEvent.prototype=Object.create(window.Event.prototype);}
function CustomNumber(input,sub,add){const self=this;this.input=input;this.sub=sub;this.add=add;this._subHandler=function(){self._change(-1);self._changeByTimer(-1);};this._addHandler=function(){self._change(1);self._changeByTimer(1);};this.sub.addEventListener('mousedown',this._subHandler,false);this.add.addEventListener('mousedown',this._addHandler,false);}
CustomNumber.prototype={destroy:function(){this.sub.removeEventListener('mousedown',this._subHandler,false);this.add.removeEventListener('mousedown',this._addHandler,false);},_change:function(direction){const step=this._step();const min=this._min();const max=this._max();let value=this._value()+step*direction;if(max!=null){value=Math.min(max,value);}
if(min!=null){value=Math.max(min,value);}
const triggerChange=this.input.value!==value.toString();this.input.value=value;if(triggerChange){this.input.dispatchEvent(new CustomEvent('change',{bubbles:true}));}},_changeByTimer:function(direction){const self=this;let interval;const timer=setTimeout(function(){interval=setInterval(function(){self._change(direction);},50);},300);const documentMouseUp=function(){clearTimeout(timer);clearInterval(interval);document.removeEventListener('mouseup',documentMouseUp,false);};document.addEventListener('mouseup',documentMouseUp,false);},_step:function(){let step=1;if(this.input.hasAttribute('step')){step=parseFloat(this.input.getAttribute('step'));step=isNaN(step)?1:step;}
return step;},_min:function(){let min=null;if(this.input.hasAttribute('min')){min=parseFloat(this.input.getAttribute('min'));min=isNaN(min)?null:min;}
return min;},_max:function(){let max=null;if(this.input.hasAttribute('max')){max=parseFloat(this.input.getAttribute('max'));max=isNaN(max)?null:max;}
return max;},_value:function(){let value=parseFloat(this.input.value);return isNaN(value)?0:value;}};$.fn.customNumber=function(options){options=$.extend({destroy:false},options);return this.each(function(){if(!$(this).is('.input-number')){return;}
let instance=$(this).data('customNumber');if(instance&&options.destroy){instance.destroy();$(this).removeData('customNumber');}else if(!instance&&!options.destroy){instance=new CustomNumber(this.querySelector('.input-number__input'),this.querySelector('.input-number__sub'),this.querySelector('.input-number__add'));$(this).data('customNumber',instance);}});};})(jQuery);;(function($){"use strict";let passiveSupported=false;try{const options=Object.defineProperty({},'passive',{get:function(){passiveSupported=true;}});window.addEventListener('test',null,options);}catch(err){}
$(function(){$('.input-number').customNumber();});$(function(){$('.topbar-dropdown__btn').on('click',function(){$(this).closest('.topbar-dropdown').toggleClass('topbar-dropdown--opened');});$(document).on('click',function(event){$('.topbar-dropdown').not($(event.target).closest('.topbar-dropdown')).removeClass('topbar-dropdown--opened');});});$(function(){$('.indicator--trigger--click .indicator__button').on('click',function(event){event.preventDefault();const dropdown=$(this).closest('.indicator');if(dropdown.is('.indicator--opened')){dropdown.removeClass('indicator--opened');}else{dropdown.addClass('indicator--opened');dropdown.find('.drop-search__input').focus();}});$('.indicator--trigger--click .drop-search__input').on('keydown',function(event){if(event.which===27){$(this).closest('.indicator').removeClass('indicator--opened');}});$(document).on('click',function(event){$('.indicator').not($(event.target).closest('.indicator')).removeClass('indicator--opened');});});$(function(){$('.product-tabs').each(function(i,element){$('.product-tabs__list',element).on('click','.product-tabs__item',function(event){event.preventDefault();const tab=$(this);const content=$('.product-tabs__pane'+$(this).attr('href'),element);if(content.length){$('.product-tabs__item').removeClass('product-tabs__item--active');tab.addClass('product-tabs__item--active');$('.product-tabs__pane').removeClass('product-tabs__pane--active');content.addClass('product-tabs__pane--active');}});const currentTab=$('.product-tabs__item--active',element);const firstTab=$('.product-tabs__item:first',element);if(currentTab.length){currentTab.trigger('click');}else{firstTab.trigger('click');}});});$(function(){$('.nav-panel__nav-links .nav-links__item').on('mouseenter',function(){const megamenu=$(this).find('.nav-links__megamenu');if(megamenu.length){const container=megamenu.offsetParent();const containerWidth=container.width();const megamenuWidth=megamenu.width();const itemPosition=$(this).position().left;const megamenuPosition=Math.round(Math.min(itemPosition,containerWidth-megamenuWidth));megamenu.css('left',megamenuPosition+'px');}});});$(function(){const mobileSearch=$('.mobile-header__search');if(mobileSearch.length){$('.indicator--mobile-search .indicator__button').on('click',function(){if(mobileSearch.is('.mobile-header__search--opened')){mobileSearch.removeClass('mobile-header__search--opened');}else{mobileSearch.addClass('mobile-header__search--opened');mobileSearch.find('input')[0].focus();}});mobileSearch.find('.mobile-header__search-button--close').on('click',function(){mobileSearch.removeClass('mobile-header__search--opened');});document.addEventListener('click',function(event){if(!$(event.target).closest('.indicator--mobile-search, .mobile-header__search').length){mobileSearch.removeClass('mobile-header__search--opened');}},true);}});$(function(){const CDepartments=function(element){const self=this;element.data('departmentsInstance',self);this.element=element;this.body=this.element.find('.departments__body');this.button=this.element.find('.departments__button');this.mode=this.element.is('.departments--fixed')?'fixed':'normal';this.fixedBy=$(this.element.data('departments-fixed-by'));this.fixedHeight=0;if(this.mode==='fixed'&&this.fixedBy.length){this.fixedHeight=this.fixedBy.offset().top-this.body.offset().top+this.fixedBy.outerHeight();this.body.css('height',this.fixedHeight+'px');}
this.button.on('click',function(event){self.clickOnButton(event);});$('.departments__links-wrapper',this.element).on('transitionend',function(event){if(event.originalEvent.propertyName==='height'){$(this).css('height','');$(this).closest('.departments').removeClass('departments--transition');}});document.addEventListener('click',function(event){self.element.not($(event.target).closest('.departments')).each(function(){if(self.element.is('.departments--opened')){self.element.data('departmentsInstance').close();}});},true);};CDepartments.prototype.clickOnButton=function(event){event.preventDefault();if(this.element.is('.departments--opened')){this.close();}else{this.open();}};CDepartments.prototype.setMode=function(mode){this.mode=mode;if(this.mode==='normal'){this.element.removeClass('departments--fixed');this.element.removeClass('departments--opened');this.body.css('height','auto');}
if(this.mode==='fixed'){this.element.addClass('departments--fixed');this.element.addClass('departments--opened');this.body.css('height',this.fixedHeight+'px');}};CDepartments.prototype.close=function(){if(this.element.is('.departments--fixed')){return;}
const content=this.element.find('.departments__links-wrapper');const startHeight=content.height();content.css('height',startHeight+'px');this.element.addClass('departments--transition').removeClass('departments--opened');content.css('height','');};CDepartments.prototype.open=function(){const content=this.element.find('.departments__links-wrapper');const startHeight=content.height();this.element.addClass('departments--transition').addClass('departments--opened');const endHeight=content.height();content.css('height',startHeight+'px');content.css('height',endHeight+'px');};const departments=new CDepartments($('.departments'));const nav=$('.nav-panel--sticky');if(nav.length){const departmentsMode=departments.mode;const defaultPosition=nav.offset().top;let stuck=false;window.addEventListener('scroll',function(){if(window.pageYOffset>defaultPosition){if(!stuck){nav.addClass('nav-panel--stuck');stuck=true;if(departmentsMode==='fixed'){departments.setMode('normal');}}}else{if(stuck){nav.removeClass('nav-panel--stuck');stuck=false;if(departmentsMode==='fixed'){departments.setMode('fixed');}}}},passiveSupported?{passive:true}:false);}});$(function(){$('.block-slideshow .owl-carousel').owlCarousel({items:1,nav:false,dots:true,loop:true});});$(function(){$('.block-brands__slider .owl-carousel').owlCarousel({nav:false,dots:false,loop:true,responsive:{1200:{items:6},992:{items:5},768:{items:4},576:{items:3},0:{items:2}}});});$(function(){$('.teammates .owl-carousel').owlCarousel({nav:false,dots:true,responsive:{768:{items:3,margin:32},380:{items:2,margin:24},0:{items:1}}});});const quickview={cancelPreviousModal:function(){},clickHandler:function(){const modal=$('#quickview-modal');const button=$(this);const doubleClick=button.is('.product-card__quickview--preload');quickview.cancelPreviousModal();if(doubleClick){return;}
button.addClass('product-card__quickview--preload');let xhr=null;const timeout=setTimeout(function(){xhr=$.ajax({url:'quickview.html',success:function(data){quickview.cancelPreviousModal=function(){};button.removeClass('product-card__quickview--preload');modal.find('.modal-content').html(data);modal.find('.quickview__close').on('click',function(){modal.modal('hide');});modal.modal('show');}});},1000);quickview.cancelPreviousModal=function(){button.removeClass('product-card__quickview--preload');if(xhr){xhr.abort();}
clearTimeout(timeout);};}};$(function(){const modal=$('#quickview-modal');modal.on('shown.bs.modal',function(){modal.find('.product').each(function(){const gallery=$(this).find('.product-gallery');if(gallery.length>0){initProductGallery(gallery[0],$(this).data('layout'));}});$('.input-number',modal).customNumber();});$('.product-card__quickview').on('click',function(){quickview.clickHandler.apply(this,arguments);});});$(function(){$('.block-products-carousel').each(function(){const layout=$(this).data('layout');const options={items:4,margin:14,nav:false,dots:false,loop:true,stagePadding:1};const layoutOptions={'grid-4':{responsive:{1200:{items:4,margin:14},992:{items:4,margin:10},768:{items:3,margin:10},576:{items:2,margin:10},475:{items:2,margin:10},0:{items:1}}},'grid-4-sm':{responsive:{1200:{items:4,margin:14},992:{items:3,margin:10},768:{items:3,margin:10},576:{items:2,margin:10},475:{items:2,margin:10},0:{items:1}}},'grid-5':{responsive:{1200:{items:5,margin:12},992:{items:4,margin:10},768:{items:3,margin:10},576:{items:2,margin:10},475:{items:2,margin:10},0:{items:1}}},'horizontal':{items:3,responsive:{1200:{items:3,margin:14},992:{items:3,margin:10},768:{items:2,margin:10},576:{items:1},475:{items:1},0:{items:1}}},};const owl=$('.owl-carousel',this);let cancelPreviousTabChange=function(){};owl.owlCarousel($.extend({},options,layoutOptions[layout]));$(this).find('.block-header__group').on('click',function(event){const block=$(this).closest('.block-products-carousel');event.preventDefault();if($(this).is('.block-header__group--active')){return;}
cancelPreviousTabChange();block.addClass('block-products-carousel--loading');$(this).closest('.block-header__groups-list').find('.block-header__group--active').removeClass('block-header__group--active');$(this).addClass('block-header__group--active');let timer;timer=setTimeout(function(){let items=block.find('.owl-carousel .owl-item:not(".cloned") .block-products-carousel__column');const itemsArray=items.get();const newItemsArray=[];while(itemsArray.length>0){const randomIndex=Math.floor(Math.random()*itemsArray.length);const randomItem=itemsArray.splice(randomIndex,1)[0];newItemsArray.push(randomItem);}
items=$(newItemsArray);block.find('.owl-carousel').trigger('replace.owl.carousel',[items]).trigger('refresh.owl.carousel').trigger('to.owl.carousel',[0,0]);$('.product-card__quickview',block).on('click',function(){quickview.clickHandler.apply(this,arguments);});block.removeClass('block-products-carousel--loading');},1000);cancelPreviousTabChange=function(){clearTimeout(timer);cancelPreviousTabChange=function(){};};});$(this).find('.block-header__arrow--left').on('click',function(){owl.trigger('prev.owl.carousel',[500]);});$(this).find('.block-header__arrow--right').on('click',function(){owl.trigger('next.owl.carousel',[500]);});});});const initProductGallery=function(element,layout){layout=layout!==undefined?layout:'standard';const options={dots:false,margin:10};const layoutOptions={standard:{responsive:{1200:{items:5},992:{items:4},768:{items:3},480:{items:5},380:{items:4},0:{items:3}}},sidebar:{responsive:{768:{items:4},480:{items:5},380:{items:4},0:{items:3}}},columnar:{responsive:{768:{items:4},480:{items:5},380:{items:4},0:{items:3}}},quickview:{responsive:{1200:{items:5},768:{items:4},480:{items:5},380:{items:4},0:{items:3}}}};const gallery=$(element);const image=gallery.find('.product-gallery__featured .owl-carousel');const carousel=gallery.find('.product-gallery__carousel .owl-carousel');image.owlCarousel({items:1,dots:false}).on('changed.owl.carousel',syncPosition);carousel.on('initialized.owl.carousel',function(){carousel.find('.product-gallery__carousel-item').eq(0).addClass('product-gallery__carousel-item--active');}).owlCarousel($.extend({},options,layoutOptions[layout]));carousel.on('click','.owl-item',function(e){e.preventDefault();image.data('owl.carousel').to($(this).index(),300,true);});function syncPosition(el){let current=el.item.index;carousel.find('.product-gallery__carousel-item').removeClass('product-gallery__carousel-item--active').eq(current).addClass('product-gallery__carousel-item--active');const onscreen=carousel.find('.owl-item.active').length-1;const start=carousel.find('.owl-item.active').first().index();const end=carousel.find('.owl-item.active').last().index();if(current>end){carousel.data('owl.carousel').to(current,100,true);}
if(current<start){carousel.data('owl.carousel').to(current-onscreen,100,true);}}};$(function(){$('.product').each(function(){const gallery=$(this).find('.product-gallery');if(gallery.length>0){initProductGallery(gallery[0],$(this).data('layout'));}});});$(function(){$('[name="checkout_payment_method"]').on('change',function(){const currentItem=$(this).closest('.payment-methods__item');$(this).closest('.payment-methods__list').find('.payment-methods__item').each(function(i,element){const links=$(element);const linksContent=links.find('.payment-methods__item-container');if(element!==currentItem[0]){const startHeight=linksContent.height();linksContent.css('height',startHeight+'px');links.removeClass('payment-methods__item--active');linksContent.css('height','');}else{const startHeight=linksContent.height();links.addClass('payment-methods__item--active');const endHeight=linksContent.height();linksContent.css('height',startHeight+'px');linksContent.css('height',endHeight+'px');}});});$('.payment-methods__item-container').on('transitionend',function(event){if(event.originalEvent.propertyName==='height'){$(this).css('height','');}});});$(function(){$('[data-collapse]').each(function(i,element){const collapse=element;const openedClass=$(element).data('collapse-opened-class');$('[data-collapse-trigger]',collapse).on('click',function(){const item=$(this).closest('[data-collapse-item]');const content=item.children('[data-collapse-content]');const itemParents=item.parents();itemParents.slice(0,itemParents.index(collapse)+1).filter('[data-collapse-item]').css('height','');if(item.is('.'+openedClass)){const startHeight=content.height();content.css('height',startHeight+'px');item.removeClass(openedClass);content.css('height','');}else{const startHeight=content.height();item.addClass(openedClass);const endHeight=content.height();content.css('height',startHeight+'px');content.css('height',endHeight+'px');}});$('[data-collapse-content]',collapse).on('transitionend',function(event){if(event.originalEvent.propertyName==='height'){$(this).css('height','');}});});});$(function(){$('.filter-price').each(function(i,element){const min=$(element).data('min');const max=$(element).data('max');const from=$(element).data('from');const to=$(element).data('to');const slider=element.querySelector('.filter-price__slider');noUiSlider.create(slider,{start:[from,to],connect:true,range:{'min':min,'max':max}});const titleValues=[$(element).find('.filter-price__min-value')[0],$(element).find('.filter-price__max-value')[0]];slider.noUiSlider.on('update',function(values,handle){titleValues[handle].innerHTML=values[handle];});});});$(function(){const body=$('body');const mobilemenu=$('.mobilemenu');if(mobilemenu.length){const open=function(){const bodyWidth=body.width();body.css('overflow','hidden');body.css('paddingRight',(body.width()-bodyWidth)+'px');mobilemenu.addClass('mobilemenu--open');};const close=function(){body.css('overflow','auto');body.css('paddingRight','');mobilemenu.removeClass('mobilemenu--open');};$('.mobile-header__menu-button').on('click',function(){open();});$('.mobilemenu__backdrop, .mobilemenu__close').on('click',function(){close();});}});$(function(){$('[data-toggle="tooltip"]').tooltip({trigger:'hover'});});$(function(){$('.layout-switcher__button').on('click',function(){const layoutSwitcher=$(this).closest('.layout-switcher');const productsView=$(this).closest('.products-view');const productsList=productsView.find('.products-list');layoutSwitcher.find('.layout-switcher__button').removeClass('layout-switcher__button--active');$(this).addClass('layout-switcher__button--active');productsList.attr('data-layout',$(this).attr('data-layout'));productsList.attr('data-with-features',$(this).attr('data-with-features'));});});var contactForm=$('.contact-form');var contactFormMethod=contactForm.attr('method');var contactFormEndPoint=contactForm.attr('action');function displaySubmitting(submitBtn,defaultText,doSubmit){if(doSubmit){submitBtn.addClass("disabled")
submitBtn.html("<i class='fa fa-spin fa-spinner'></i> Sending...")}else{submitBtn.removeClass("disabled")
submitBtn.html(defaultText)}}
contactForm.submit(function(event){event.preventDefault();var contactFormSubmitBtn=contactForm.find("[type='submit']");var contactFormSubmitBtnTxt=contactFormSubmitBtn.text();var contactFormData=contactForm.serialize();var thisForm=$(this);displaySubmitting(contactFormSubmitBtn,"",true);$.ajax({method:contactFormMethod,url:contactFormEndpoint,data:contactFormData,success:function(data){contactForm[0].reset()
$.alert({title:"Success!",content:data.message,theme:"modern",})
setTimeout(function(){displaySubmitting(contactFormSubmitBtn,contactFormSubmitBtnTxt,false)},500)},error:function(error){console.log(error.responseJSON)
var jsonData=error.responseJSON;var msg="";$.each(jsonData,function(key,value){msg+=key+": "+value[0].message+"<br/>"})
$.alert({title:"Oops!",content:msg,theme:"modern",});setTimeout(function(){displaySubmitting(contactFormSubmitBtn,contactFormSubmitBtnTxt,false)},500)}})});})(jQuery);;$(document).ready(function(){function getCookie(name){var cookieValue=null;if(document.cookie&&document.cookie!==''){var cookies=document.cookie.split(';');for(var i=0;i<cookies.length;i++){var cookie=jQuery.trim(cookies[i]);if(cookie.substring(0,name.length+1)===(name+'=')){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break;}}}
return cookieValue;}
var csrftoken=getCookie('csrftoken');function csrfSafeMethod(method){return(/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));}
$.ajaxSetup({beforeSend:function(xhr,settings){if(!csrfSafeMethod(settings.type)&&!this.crossDomain){xhr.setRequestHeader("X-CSRFToken",csrftoken);}}});var searchForm=$(".search__form")
var searchInput=searchForm.find("[name='q']")
var typingTimer;var typingInterval=100
var searchBtn=searchForm.find("[type='submit']")
searchInput.keyup(function(event){clearTimeout(typingTimer)
typingTimer=setTimeout(perfomSearch,typingInterval)})
searchInput.keydown(function(event){clearTimeout(typingTimer)})
function displaySearching(){searchBtn.addClass("disabled")
searchBtn.html("<i class='fa fa-spin fa-spinner'></i>")}
function perfomSearch(){displaySearching()
var query=searchInput.val()}
var productForm=$(".product__actions");function getOwnedProduct(productId,submitSpan){var actionEndpoint='/orders/endpoint/verify/ownership/'
var httpMethod='GET';var data={product_id:productId}
var isOwner;$.ajax({url:actionEndpoint,method:httpMethod,data:data,success:function(data){console.log(data)
console.log(data.owner)
if(data.owner){isOwner=true
submitSpan.html("<a class='btn btn-warning' href='/library/'>In Library</a>")}else{isOwner=false}},error:function(erorr){console.log(error)}});return isOwner}
$.each(productForm,function(index,object){var $this=$(this)
var isUser=$this.attr("data-user")
var submitSpan=$this.find(".submit")
var productInput=$this.find("[name='product_id']")
var productId=productInput.attr("value")
if(isUser){var isOwned=getOwnedProduct(productId,submitSpan)}})
productForm.submit(function(event){event.preventDefault();var thisForm=$(this)
var actionEndpoint=thisForm.attr("data-endpoint")
var httpMethod=thisForm.attr("method");var formData=thisForm.serialize();$.ajax({url:actionEndpoint,method:httpMethod,data:formData,success:function(data){var submitSpan=thisForm.find(".submit")
if(data.added){submitSpan.html("<div class='product__actions-item product__actions-item--addtocart submit'> <a href='/location/detail/' class='btn btn-primary btn-lg'>Delete ?</a> </div>")}else{submitSpan.html("<button type='submit' class='btn btn-primary btn-lg'>louer</button>")}
var navbarCount=$(".location_items_count")
navbarCount.text(data.LocationItemCount)
var currentPath=window.location.href
if(currentPath.indexOf("location")!=-1){refreshCart()}},error:function(errorData){$.alert({title:"Oops!",content:"An error occurred",theme:"modern",})}})})
function refreshCart(){console.log("in current cart")
var cartTable=$(".cart-table")
var cartBody=cartTable.find(".cart-body")
var productRows=cartBody.find(".cart-table__row")
var currentUrl=window.location.href
var refreshCartUrl='/api/location/'
var refreshCartMethod="GET";var data={};$.ajax({url:refreshCartUrl,method:refreshCartMethod,data:data,success:function(data){var hiddenLocationItemRemoveForm=$(".remove_location")
if(data.product.length>0){productRows.html(" ")
i=data.product.length
$.each(data.product,function(index,value){console.log(value)
var newLocationItemRemove=hiddenLocationItemRemoveForm.clone()
newLocationItemRemove.css("display","block")
newLocationItemRemove.find(".remove_location").val(value.id)
cartBody.prepend("<tr><th scope=\"row\">"+i+"</th><td><a href='"+value.url+"'>"+value.name+"</a>"+newLocationItemRemove.html()+"</td><td>"+value.price+"</td></tr>")
i--})
cartBody.find(".cart-subtotal").text(data.subtotal)
cartBody.find(".cart-total").text(data.total)}else{window.location.href=currentUrl}},error:function(errorData){$.alert({title:"Oops!",content:"An error occurred",theme:"modern",})}})}});;$(document).ready(function(){"use strict";var stripeFormModule=$(".stripe-payment-form")
var stripeModuleToken=stripeFormModule.attr("data-token")
var stripeModuleNextUrl=stripeFormModule.attr("data-next-url")
var stripeModuleBtnTitle=stripeFormModule.attr("data-btn-title")||"Add card"
var stripeTemplate=$.templates("#stripeTemplate")
var stripeTemplateDataContext={publishKey:stripeModuleToken,nextUrl:stripeModuleNextUrl,btnTitle:stripeModuleBtnTitle}
var stripeTemplateHtml=stripeTemplate.render(stripeTemplateDataContext)
stripeFormModule.html(stripeTemplateHtml)
var paymentForm=$(".payment-form")
if(paymentForm.length>1){alert("Only one payment form is allowed per page")
paymentForm.css('display','none')}
else if(paymentForm.length==1){var pubKey=paymentForm.attr('data-token')
var nextUrl=paymentForm.attr('data-next-url')
var stripe=Stripe(pubKey);var elements=stripe.elements();var style={base:{color:'#32325d',lineHeight:'24px',fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSmoothing:'antialiased',fontSize:'16px','::placeholder':{color:'#aab7c4'}},invalid:{color:'#fa755a',iconColor:'#fa755a'}};var card=elements.create('card',{style:style});card.mount('#card-element');card.addEventListener('change',function(event){var displayError=document.getElementById('card-errors');if(event.error){displayError.textContent=event.error.message;}else{displayError.textContent='';}});var form=$('#payment-form');var btnLoad=form.find(".btn-load")
var btnLoadDefaultHtml=btnLoad.html()
var btnLoadDefaultClasses=btnLoad.attr("class")
form.on('submit',function(event){event.preventDefault();var $this=$(this)
btnLoad.blur()
var loadTime=1500
var currentTimeout;var errorHtml="<i class='fa fa-warning'></i> An error occured"
var errorClasses="btn btn-danger disabled my-3"
var loadingHtml="<i class='fa fa-spin fa-spinner'></i> Loading..."
var loadingClasses="btn btn-success disabled my-3"
stripe.createToken(card).then(function(result){if(result.error){var errorElement=$('#card-errors');errorElement.textContent=result.error.message;currentTimeout=displayBtnStatus(btnLoad,errorHtml,errorClasses,1000,currentTimeout)}else{currentTimeout=displayBtnStatus(btnLoad,loadingHtml,loadingClasses,10000,currentTimeout)
stripeTokenHandler(nextUrl,result.token);}});});function displayBtnStatus(element,newHtml,newClasses,loadTime,timeout){if(!loadTime){loadTime=1500}
element.html(newHtml)
element.removeClass(btnLoadDefaultClasses)
element.addClass(newClasses)
return setTimeout(function(){element.html(btnLoadDefaultHtml)
element.removeClass(newClasses)
element.addClass(btnLoadDefaultClasses)},loadTime)}
function redirectToNext(nextPath,timeoffset){if(nextPath){setTimeout(function(){window.location.href=nextPath},timeoffset)}}
function stripeTokenHandler(nextUrl,token){var paymentMethodEndpoint='/payment/process/done/'
var data={'token':token.id}
$.ajax({data:data,url:paymentMethodEndpoint,method:"POST",success:function(data){var succesMsg=data.message||"Success! Your card was added."
card.clear()
if(nextUrl){succesMsg=succesMsg+"Redirecting..."}
if($.alert){$.alert(succesMsg)}else{alert(succesMsg)}
btnLoad.html(btnLoadDefaultHtml)
btnLoad.attr('class',btnLoadDefaultClasses)
redirectToNext(nextUrl,1500)},error:function(error){console.log(error)
$.alert({title:"An error occured",content:"Please try adding your card again."})
btnLoad.html(btnLoadDefaultHtml)
btnLoad.attr('class',btnLoadDefaultClasses)}})}}});;